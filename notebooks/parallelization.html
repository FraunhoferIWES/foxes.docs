

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="">
    
    
      
        <title>Parallelization - foxes 1.1.1 documentation</title>
      
    
    
      
        
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.3625f807144f53acf.min.css?v=fbfc4466" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Available-engines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="foxes 1.1.1 documentation" class="md-header__button md-logo" aria-label="foxes 1.1.1 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            foxes 1.1.1 documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Parallelization
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/FraunhoferIWES/foxes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    foxes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="foxes 1.1.1 documentation" class="md-nav__button md-logo" aria-label="foxes 1.1.1 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>
    </a>
    foxes 1.1.1 documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/FraunhoferIWES/foxes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    foxes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../citation.html" class="md-nav__link">
        <span title="/citation.md (reference label)" class="md-ellipsis">Citation</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        <span title="/installation.md (reference label)" class="md-ellipsis">Installation</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        <span title="/overview.md (reference label)" class="md-ellipsis">Overview -<wbr> how to setup foxes</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../inputs.html" class="md-nav__link">
        <span title="/inputs.rst (reference label)" class="md-ellipsis">Inputs</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../models.html" class="md-nav__link">
        <span title="/models.rst (reference label)" class="md-ellipsis">Models</span>
      </a>
    </li>
  

    
      
      
      

  
  
    
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <span title="/notebooks/parallelization.ipynb (reference label)" class="md-ellipsis">Parallelization</span>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        <span title="/notebooks/parallelization.ipynb (reference label)" class="md-ellipsis">Parallelization</span>
      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/notebooks/parallelization.ipynb (reference label)" class="md-ellipsis">Parallelization</span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Available-engines" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#available-engines (reference label)" class="md-ellipsis">Available engines</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Default-engine" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#default-engine (reference label)" class="md-ellipsis">Default engine</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Engine-selection-through-the-algorithm" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#engine-selection-through-the-algorithm (reference label)" class="md-ellipsis">Engine selection through the algorithm</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Engine-selection-through-a-with-block" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#engine-selection-through-a-with-block (reference label)" class="md-ellipsis">Engine selection through a with-<wbr>block</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Manual-engine-selection" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#manual-engine-selection (reference label)" class="md-ellipsis">Manual engine selection</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Remarks-&-recommendations" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#remarks-&amp;-recommendations (reference label)" class="md-ellipsis">Remarks &amp; recommendations</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../examples.html" class="md-nav__link">
        <span title="/examples.rst (reference label)" class="md-ellipsis">Examples</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../optimization.html" class="md-nav__link">
        <span title="/optimization.md (reference label)" class="md-ellipsis">Optimization</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../api.html" class="md-nav__link">
        <span title="/api.rst (reference label)" class="md-ellipsis">API</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="data.html" class="md-nav__link">
        <span title="/notebooks/data.ipynb (reference label)" class="md-ellipsis">Static data</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../testing.html" class="md-nav__link">
        <span title="/testing.md (reference label)" class="md-ellipsis">Testing</span>
      </a>
    </li>
  

    
      
      
      

  
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG.html" class="md-nav__link">
        <span title="/changelog.md (reference label)" class="md-ellipsis">History</span>
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      <span title="/notebooks/parallelization.ipynb (reference label)" class="md-ellipsis">Parallelization</span>
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Available-engines" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#available-engines (reference label)" class="md-ellipsis">Available engines</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Default-engine" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#default-engine (reference label)" class="md-ellipsis">Default engine</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Engine-selection-through-the-algorithm" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#engine-selection-through-the-algorithm (reference label)" class="md-ellipsis">Engine selection through the algorithm</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Engine-selection-through-a-with-block" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#engine-selection-through-a-with-block (reference label)" class="md-ellipsis">Engine selection through a with-<wbr>block</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Manual-engine-selection" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#manual-engine-selection (reference label)" class="md-ellipsis">Manual engine selection</span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Remarks-&-recommendations" class="md-nav__link">
    <span title="/notebooks/parallelization.ipynb#remarks-&amp;-recommendations (reference label)" class="md-ellipsis">Remarks &amp; recommendations</span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                  


<script src='http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js'></script>
<script>require=requirejs;</script><h1 id="Parallelization">Parallelization<a class="headerlink" href="#Parallelization" title="Link to this heading">¶</a></h1>
<p>Even for large cases <em>foxes</em> calculations are fast, thanks to</p>
<ul class="simple">
<li><p><strong>Vectorization:</strong> The states (and also the points, in the case of data calculation at evaluation points) are split into so-called <em>chunks</em>, which are sub-arrays of the large original data.</p></li>
<li><p><strong>Parallelization:</strong> These chunks are being sent to individual processes for calculation. Those calculations can be carried out simultaneously, i.e., <em>in parallel</em>.</p></li>
</ul>
<p>Vectorization and parallelization are managed by so-called <em>engines</em> in <em>foxes</em>. If you do not explicitly specify the engine, a default will be chosen. This means that even if you do not know or care about <em>foxes</em> engines, your calculations will be vectorized and parallelized.</p>
<h2 id="Available-engines">Available engines<a class="headerlink" href="#Available-engines" title="Link to this heading">¶</a></h2>
<p>These are the currently available engines, where each can be addressed by the short name or the full class name:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Short name</p></th>
<th class="head"><p>Class name</p></th>
<th class="head"><p>Base package</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>threads</p></td>
<td><p>ThreadsEngine</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html">co
ncurrent.futures</a></p></td>
<td><p>Runs on a workstation/laptop, sends chunks to threads</p></td>
</tr>
<tr class="row-odd"><td><p>process</p></td>
<td><p>ProcessEngine</p></td>
<td><p><a class="reference external" href="https://docs.python.org/3/library/concurrent.futures.html">co
ncurrent.futures</a></p></td>
<td><p>Runs on a workstation/laptop, sends chunks to parallel processes</p></td>
</tr>
<tr class="row-even"><td><p>multiprocess</p></td>
<td><p>MultiprocessEngine</p></td>
<td><p><a class="reference external" href="https://github.com/uqfoundation/multiprocess">multiprocess</a></p></td>
<td><p>Runs on a workstation/laptop, sends chunks to parallel processes</p></td>
</tr>
<tr class="row-odd"><td><p>ray</p></td>
<td><p>RayEngine</p></td>
<td><p><a class="reference external" href="hhttps://docs.ray.io/en/latest/">ray</a></p></td>
<td><p>Runs on a workstation/laptop, sends chunks to parallel processes</p></td>
</tr>
<tr class="row-even"><td><p>dask</p></td>
<td><p>DaskEngine</p></td>
<td><p><a class="reference external" href="https://www.dask.org/">dask</a></p></td>
<td><p>Runs on a workstation/laptop, using processes or threads</p></td>
</tr>
<tr class="row-odd"><td><p>xarray</p></td>
<td><p>XArrayEngine</p></td>
<td><p><a class="reference external" href="https://docs.xarray.dev/en/stable/">xarray</a></p></td>
<td><p>Runs on a workstation/laptop, involving <a class="reference external" href="https://www.dask.org/">dask</a> through <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.apply_ufunc.html">apply_ufunc</a></p></td>
</tr>
<tr class="row-even"><td><p>local_cluster</p></td>
<td><p>LocalClusterEngine</p></td>
<td><p><a class="reference external" href="https://distributed.dask.org/en/stable/">distributed</a></p></td>
<td><p>Runs on a workstation/laptop, creates a virtual local cluster</p></td>
</tr>
<tr class="row-odd"><td><p>slurm_cluster</p></td>
<td><p>SlurmClusterEngine</p></td>
<td><p><a class="reference external" href="https://jobqueue.dask.org/en/latest/generated/dask_jobqueue.SLURMCluster.html">dask_jobqueue</a></p></td>
<td><p>Runs on a multi-node HPC cluster which is using SLURM</p></td>
</tr>
<tr class="row-even"><td><p>mpi</p></td>
<td><p>MPIEngine</p></td>
<td><p><a class="reference external" href="https://mpi4py.readthedocs.io/en/stable/index.html">mpi4py</a></p></td>
<td><p>Runs on laptop/workstation/cluster, also supports multi-node runs</p></td>
</tr>
<tr class="row-odd"><td><p>numpy</p></td>
<td><p>NumpyEngine</p></td>
<td><p><a class="reference external" href="https://numpy.org/">numpy</a></p></td>
<td><p>Runs a loop over chunks, without parallelization</p></td>
</tr>
<tr class="row-even"><td><p>single</p></td>
<td><p>SingleChunkEngine</p></td>
<td><p><a class="reference external" href="https://numpy.org/">numpy</a></p></td>
<td><p>Runs all in a single chunk, without parallelization</p></td>
</tr>
<tr class="row-odd"><td><p>default</p></td>
<td><p>DefaultEngine</p></td>
<td><p>(variable)</p></td>
<td><p>Runs either the <code class="docutils literal notranslate"><span class="pre">single</span></code> or the <code class="docutils literal notranslate"><span class="pre">process</span></code> engine, depending on the case size</p></td>
</tr>
</tbody>
</table>
<p>Note that the external packages are not installed by default. You can install them manually on demand, or use the option <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">foxes[eng]</span></code> for the complete installation of all requirements of the complete list of engines.</p>
<p>Furthermore, scripts that use the <code class="docutils literal notranslate"><span class="pre">mpi</span></code> engine have to be started in a special way. For example, when running a script named <code class="docutils literal notranslate"><span class="pre">run.py</span></code> on 12 processors, the terminal command is</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><code><span class="go">mpiexec -n 12 python -m mpi4py.futures run.py</span>
</code></pre></div>
</div>
<h2 id="Default-engine">Default engine<a class="headerlink" href="#Default-engine" title="Link to this heading">¶</a></h2>
<p>Let’s start by importing <em>foxes</em> and other required packages:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">foxes</span>
<span class="kn">import</span> <span class="nn">foxes.variables</span> <span class="k">as</span> <span class="nn">FV</span>
</code></pre></div>
</div>
</div>
<p>Next, we create a random wind farm and a random time series:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">n_times</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">n_turbines</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">sdata</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">create</span><span class="o">.</span><span class="n">random_timseries_data</span><span class="p">(</span>
    <span class="n">n_times</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">Timeseries</span><span class="p">(</span>
    <span class="n">data_source</span><span class="o">=</span><span class="n">sdata</span><span class="p">,</span>
    <span class="n">output_vars</span><span class="o">=</span><span class="p">[</span><span class="n">FV</span><span class="o">.</span><span class="n">WS</span><span class="p">,</span> <span class="n">FV</span><span class="o">.</span><span class="n">WD</span><span class="p">,</span> <span class="n">FV</span><span class="o">.</span><span class="n">TI</span><span class="p">,</span> <span class="n">FV</span><span class="o">.</span><span class="n">RHO</span><span class="p">],</span>
    <span class="n">fixed_vars</span><span class="o">=</span><span class="p">{</span><span class="n">FV</span><span class="o">.</span><span class="n">RHO</span><span class="p">:</span> <span class="mf">1.225</span><span class="p">,</span> <span class="n">FV</span><span class="o">.</span><span class="n">TI</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">farm</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">WindFarm</span><span class="p">()</span>
<span class="n">foxes</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">farm_layout</span><span class="o">.</span><span class="n">add_random</span><span class="p">(</span>
    <span class="n">farm</span><span class="p">,</span> <span class="n">n_turbines</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">turbine_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;DTU10MW&quot;</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">sdata</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>Out[3]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WS</th>
      <th>WD</th>
    </tr>
    <tr>
      <th>Time</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01 00:00:00</th>
      <td>11.236204</td>
      <td>141.708787</td>
    </tr>
    <tr>
      <th>2000-01-01 01:00:00</th>
      <td>28.521429</td>
      <td>170.436837</td>
    </tr>
    <tr>
      <th>2000-01-01 02:00:00</th>
      <td>21.959818</td>
      <td>307.637062</td>
    </tr>
    <tr>
      <th>2000-01-01 03:00:00</th>
      <td>17.959755</td>
      <td>122.401579</td>
    </tr>
    <tr>
      <th>2000-01-01 04:00:00</th>
      <td>4.680559</td>
      <td>313.073887</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000-07-27 03:00:00</th>
      <td>26.921920</td>
      <td>308.756156</td>
    </tr>
    <tr>
      <th>2000-07-27 04:00:00</th>
      <td>3.581430</td>
      <td>323.103181</td>
    </tr>
    <tr>
      <th>2000-07-27 05:00:00</th>
      <td>9.835285</td>
      <td>340.814849</td>
    </tr>
    <tr>
      <th>2000-07-27 06:00:00</th>
      <td>24.472361</td>
      <td>143.095677</td>
    </tr>
    <tr>
      <th>2000-07-27 07:00:00</th>
      <td>17.919371</td>
      <td>78.170545</td>
    </tr>
  </tbody>
</table>
<p>5000 rows × 2 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">foxes</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">FarmLayoutOutput</span><span class="p">(</span><span class="n">farm</span><span class="p">)</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parallelization_11_0.png" src="../_images/notebooks_parallelization_11_0.png" />
</div>
</div>
<p>You can run the wind farm calculations by simply creating an algorithm and calling <em>farm_calc</em>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">algo</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Downwind</span><span class="p">(</span>
    <span class="n">farm</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">rotor_model</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
    <span class="n">wake_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bastankhah2014_linear_k004&quot;</span><span class="p">],</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">farm_results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">calc_farm</span><span class="p">()</span>
<span class="n">farm_results</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initializing model &#39;Timeseries&#39;

Initializing algorithm &#39;Downwind&#39;

--------------------------------------------------
  Running Downwind: calc_farm
--------------------------------------------------
  n_states : 5000
  n_turbines: 100
--------------------------------------------------
  states   : Timeseries()
  rotor    : CentreRotor()
  controller: BasicFarmController()
  wake frame: RotorWD()
--------------------------------------------------
  wakes:
    0) Bastankhah2014_linear_k004: Bastankhah2014(ws_linear, induction=Madsen, k=0.04)
--------------------------------------------------
  partial wakes:
    0) Bastankhah2014_linear_k004: axiwake6, PartialAxiwake(n=6)
--------------------------------------------------
  turbine models:
    0) DTU10MW: PCtFile(D=178.3, H=119.0, P_nominal=10000.0, P_unit=kW, rho=1.225, var_ws_ct=REWS2, var_ws_P=REWS3)
--------------------------------------------------


--------------------------------------------------
  Model oder
--------------------------------------------------
00) basic_ctrl
01) InitFarmData
02) centre
03) basic_ctrl
  03.0) Post-rotor: DTU10MW
04) SetAmbFarmResults
05) FarmWakesCalculation
06) ReorderFarmOutput
--------------------------------------------------


Input data:

 &lt;xarray.Dataset&gt; Size: 5MB
Dimensions:          (state: 5000, turbine: 100, Timeseries_vars: 2, tmodels: 1)
Coordinates:
  * state            (state) datetime64[ns] 40kB 2000-01-01 ... 2000-07-27T07...
  * Timeseries_vars  (Timeseries_vars) &lt;U2 16B &#39;WD&#39; &#39;WS&#39;
  * tmodels          (tmodels) &lt;U7 28B &#39;DTU10MW&#39;
Dimensions without coordinates: turbine
Data variables:
    weight           (state, turbine) float64 4MB 0.0002 0.0002 ... 0.0002
    Timeseries_data  (state, Timeseries_vars) float64 80kB 141.7 11.24 ... 17.92
    tmodel_sels      (state, turbine, tmodels) bool 500kB True True ... True


Farm variables: AMB_CT, AMB_P, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_RHO, AMB_TI, AMB_WD, AMB_YAW, CT, D, H, P, REWS, REWS2, REWS3, RHO, TI, WD, X, Y, YAW, order, order_inv, order_ssel, weight

Output variables: AMB_CT, AMB_P, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_RHO, AMB_TI, AMB_WD, AMB_YAW, CT, D, H, P, REWS, REWS2, REWS3, RHO, TI, WD, X, Y, YAW, order, order_inv, order_ssel, weight
Selecting &#39;DefaultEngine(n_procs=16, chunk_size_states=None, chunk_size_points=20000)&#39;


</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>Out[6]:
</code></pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 104MB
Dimensions:     (state: 5000, turbine: 100)
Coordinates:
  * state       (state) datetime64[ns] 40kB 2000-01-01 ... 2000-07-27T07:00:00
Dimensions without coordinates: turbine
Data variables: (12/27)
    AMB_CT      (state, turbine) float64 4MB 0.758 0.758 0.758 ... 0.1502 0.1502
    AMB_P       (state, turbine) float64 4MB 9.921e+03 9.921e+03 ... 1.064e+04
    AMB_REWS    (state, turbine) float64 4MB 11.24 11.24 11.24 ... 17.92 17.92
    AMB_REWS2   (state, turbine) float64 4MB 11.24 11.24 11.24 ... 17.92 17.92
    AMB_REWS3   (state, turbine) float64 4MB 11.24 11.24 11.24 ... 17.92 17.92
    AMB_RHO     (state, turbine) float64 4MB 1.225 1.225 1.225 ... 1.225 1.225
    ...          ...
    YAW         (state, turbine) float64 4MB 141.7 141.7 141.7 ... 78.17 78.17
    order       (state, turbine) int64 4MB 44 33 39 81 57 70 ... 22 20 27 92 56
    order_inv   (state, turbine) int64 4MB 76 77 54 75 85 15 ... 16 21 89 39 71
    order_ssel  (state, turbine) int64 4MB 0 0 0 0 0 0 ... 312 312 312 312 312
    weight      (state, turbine) float64 4MB 0.0002 0.0002 ... 0.0002 0.0002
    tname       (turbine) &lt;U3 1kB &#x27;T0&#x27; &#x27;T1&#x27; &#x27;T2&#x27; &#x27;T3&#x27; ... &#x27;T97&#x27; &#x27;T98&#x27; &#x27;T99&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d6e2eb18-381d-42a0-b0bf-8546d00acaa8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d6e2eb18-381d-42a0-b0bf-8546d00acaa8' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>state</span>: 5000</li><li><span>turbine</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d77d4b6f-6af8-41b3-9e1f-e9373756ee8e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d77d4b6f-6af8-41b3-9e1f-e9373756ee8e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>state</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2000-01-01 ... 2000-07-27T07:00:00</div><input id='attrs-b290c84d-8287-457f-a536-220339c812e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b290c84d-8287-457f-a536-220339c812e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ce894ee8-37c2-4457-93ac-e37ac0a5d2a3' class='xr-var-data-in' type='checkbox'><label for='data-ce894ee8-37c2-4457-93ac-e37ac0a5d2a3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2000-01-01T00:00:00.000000000&#x27;, &#x27;2000-01-01T01:00:00.000000000&#x27;,
       &#x27;2000-01-01T02:00:00.000000000&#x27;, ..., &#x27;2000-07-27T05:00:00.000000000&#x27;,
       &#x27;2000-07-27T06:00:00.000000000&#x27;, &#x27;2000-07-27T07:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0dbbe438-f725-484e-b9c5-bf0503a55d59' class='xr-section-summary-in' type='checkbox'  ><label for='section-0dbbe438-f725-484e-b9c5-bf0503a55d59' class='xr-section-summary' >Data variables: <span>(27)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>AMB_CT</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.758 0.758 0.758 ... 0.1502 0.1502</div><input id='attrs-d7ffb095-908c-4a04-ab14-8ef821de8211' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d7ffb095-908c-4a04-ab14-8ef821de8211' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08788532-028e-4707-a5fd-5c2288875c99' class='xr-var-data-in' type='checkbox'><label for='data-08788532-028e-4707-a5fd-5c2288875c99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.75801975, 0.75801975, 0.75801975, ..., 0.75801975, 0.75801975,
        0.75801975],
       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.084442  , 0.084442  , 0.084442  , ..., 0.084442  , 0.084442  ,
        0.084442  ],
       ...,
       [0.814     , 0.814     , 0.814     , ..., 0.814     , 0.814     ,
        0.814     ],
       [0.06269347, 0.06269347, 0.06269347, ..., 0.06269347, 0.06269347,
        0.06269347],
       [0.15017697, 0.15017697, 0.15017697, ..., 0.15017697, 0.15017697,
        0.15017697]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_P</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9.921e+03 9.921e+03 ... 1.064e+04</div><input id='attrs-160f6722-6563-4131-8687-3c0f25c036ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-160f6722-6563-4131-8687-3c0f25c036ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20f5a3e2-3f85-48c6-a1d1-f072233de6ae' class='xr-var-data-in' type='checkbox'><label for='data-20f5a3e2-3f85-48c6-a1d1-f072233de6ae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 9920.52031435,  9920.52031435,  9920.52031435, ...,
         9920.52031435,  9920.52031435,  9920.52031435],
       [    0.        ,     0.        ,     0.        , ...,
            0.        ,     0.        ,     0.        ],
       [10641.31250889, 10641.31250889, 10641.31250889, ...,
        10641.31250889, 10641.31250889, 10641.31250889],
       ...,
       [ 6961.23755919,  6961.23755919,  6961.23755919, ...,
         6961.23755919,  6961.23755919,  6961.23755919],
       [10639.86834479, 10639.86834479, 10639.86834479, ...,
        10639.86834479, 10639.86834479, 10639.86834479],
       [10639.90806287, 10639.90806287, 10639.90806287, ...,
        10639.90806287, 10639.90806287, 10639.90806287]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_REWS</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>11.24 11.24 11.24 ... 17.92 17.92</div><input id='attrs-7a546e5e-7265-47c4-b6ae-7c04781c6d84' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7a546e5e-7265-47c4-b6ae-7c04781c6d84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ecdd7df6-8a0b-48b0-b94c-ca42dc9c328b' class='xr-var-data-in' type='checkbox'><label for='data-ecdd7df6-8a0b-48b0-b94c-ca42dc9c328b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[11.23620357, 11.23620357, 11.23620357, ..., 11.23620357,
        11.23620357, 11.23620357],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.95981825, 21.95981825, 21.95981825, ..., 21.95981825,
        21.95981825, 21.95981825],
       ...,
       [ 9.83528514,  9.83528514,  9.83528514, ...,  9.83528514,
         9.83528514,  9.83528514],
       [24.47236142, 24.47236142, 24.47236142, ..., 24.47236142,
        24.47236142, 24.47236142],
       [17.91937135, 17.91937135, 17.91937135, ..., 17.91937135,
        17.91937135, 17.91937135]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_REWS2</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>11.24 11.24 11.24 ... 17.92 17.92</div><input id='attrs-60784573-5399-4955-82b6-afc179823187' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-60784573-5399-4955-82b6-afc179823187' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc23e6f1-15fa-42fc-ab5a-5bb0a9e79e3f' class='xr-var-data-in' type='checkbox'><label for='data-bc23e6f1-15fa-42fc-ab5a-5bb0a9e79e3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[11.23620357, 11.23620357, 11.23620357, ..., 11.23620357,
        11.23620357, 11.23620357],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.95981825, 21.95981825, 21.95981825, ..., 21.95981825,
        21.95981825, 21.95981825],
       ...,
       [ 9.83528514,  9.83528514,  9.83528514, ...,  9.83528514,
         9.83528514,  9.83528514],
       [24.47236142, 24.47236142, 24.47236142, ..., 24.47236142,
        24.47236142, 24.47236142],
       [17.91937135, 17.91937135, 17.91937135, ..., 17.91937135,
        17.91937135, 17.91937135]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_REWS3</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>11.24 11.24 11.24 ... 17.92 17.92</div><input id='attrs-7d271282-d914-4b78-a2b3-20d2d986d64a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d271282-d914-4b78-a2b3-20d2d986d64a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd0f7c6f-3bce-4c67-8dbe-cbfdf09a9732' class='xr-var-data-in' type='checkbox'><label for='data-cd0f7c6f-3bce-4c67-8dbe-cbfdf09a9732' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[11.23620357, 11.23620357, 11.23620357, ..., 11.23620357,
        11.23620357, 11.23620357],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.95981825, 21.95981825, 21.95981825, ..., 21.95981825,
        21.95981825, 21.95981825],
       ...,
       [ 9.83528514,  9.83528514,  9.83528514, ...,  9.83528514,
         9.83528514,  9.83528514],
       [24.47236142, 24.47236142, 24.47236142, ..., 24.47236142,
        24.47236142, 24.47236142],
       [17.91937135, 17.91937135, 17.91937135, ..., 17.91937135,
        17.91937135, 17.91937135]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_RHO</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.225 1.225 1.225 ... 1.225 1.225</div><input id='attrs-67c0b2b0-1edf-4af1-a5d4-2956a25efb8c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-67c0b2b0-1edf-4af1-a5d4-2956a25efb8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e26e0e84-0827-47ff-beed-91b336984833' class='xr-var-data-in' type='checkbox'><label for='data-e26e0e84-0827-47ff-beed-91b336984833' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       ...,
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_TI</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02 0.02 0.02 ... 0.02 0.02 0.02</div><input id='attrs-95ebd460-b77f-474b-af75-ec45ebd8f258' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-95ebd460-b77f-474b-af75-ec45ebd8f258' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9dbd60c-4e12-40e3-88c1-0d83b6f08e08' class='xr-var-data-in' type='checkbox'><label for='data-f9dbd60c-4e12-40e3-88c1-0d83b6f08e08' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       ...,
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_WD</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>141.7 141.7 141.7 ... 78.17 78.17</div><input id='attrs-e23e33d0-8113-4e8e-b70b-0fe70c08c809' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e23e33d0-8113-4e8e-b70b-0fe70c08c809' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7884401-981e-45c2-9f43-df75d156f69e' class='xr-var-data-in' type='checkbox'><label for='data-b7884401-981e-45c2-9f43-df75d156f69e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[141.7087873 , 141.7087873 , 141.7087873 , ..., 141.7087873 ,
        141.7087873 , 141.7087873 ],
       [170.43683738, 170.43683738, 170.43683738, ..., 170.43683738,
        170.43683738, 170.43683738],
       [307.63706155, 307.63706155, 307.63706155, ..., 307.63706155,
        307.63706155, 307.63706155],
       ...,
       [340.81484941, 340.81484941, 340.81484941, ..., 340.81484941,
        340.81484941, 340.81484941],
       [143.09567727, 143.09567727, 143.09567727, ..., 143.09567727,
        143.09567727, 143.09567727],
       [ 78.17054545,  78.17054545,  78.17054545, ...,  78.17054545,
         78.17054545,  78.17054545]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AMB_YAW</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>141.7 141.7 141.7 ... 78.17 78.17</div><input id='attrs-5a4773d7-1983-4802-88ed-13d15c13a43d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a4773d7-1983-4802-88ed-13d15c13a43d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79b052c9-227d-41ec-9458-0309dac02cf5' class='xr-var-data-in' type='checkbox'><label for='data-79b052c9-227d-41ec-9458-0309dac02cf5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[141.7087873 , 141.7087873 , 141.7087873 , ..., 141.7087873 ,
        141.7087873 , 141.7087873 ],
       [170.43683738, 170.43683738, 170.43683738, ..., 170.43683738,
        170.43683738, 170.43683738],
       [307.63706155, 307.63706155, 307.63706155, ..., 307.63706155,
        307.63706155, 307.63706155],
       ...,
       [340.81484941, 340.81484941, 340.81484941, ..., 340.81484941,
        340.81484941, 340.81484941],
       [143.09567727, 143.09567727, 143.09567727, ..., 143.09567727,
        143.09567727, 143.09567727],
       [ 78.17054545,  78.17054545,  78.17054545, ...,  78.17054545,
         78.17054545,  78.17054545]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CT</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.814 0.814 0.814 ... 0.1581 0.1557</div><input id='attrs-f7bf4713-98bb-4c4f-afef-0d952afe0896' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f7bf4713-98bb-4c4f-afef-0d952afe0896' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb9e828b-29a7-485f-a948-b396143850ed' class='xr-var-data-in' type='checkbox'><label for='data-eb9e828b-29a7-485f-a948-b396143850ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.814     , 0.814     , 0.814     , ..., 0.814     , 0.814     ,
        0.814     ],
       [0.        , 0.        , 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.08658958, 0.084442  , 0.08488862, ..., 0.084442  , 0.08658875,
        0.084442  ],
       ...,
       [0.814     , 0.814     , 0.82716779, ..., 0.814     , 0.814     ,
        0.814     ],
       [0.06622469, 0.06398366, 0.06307007, ..., 0.06453622, 0.06336152,
        0.0654317 ],
       [0.16822775, 0.15467746, 0.15318621, ..., 0.15784041, 0.15805114,
        0.15573179]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>D</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>178.3 178.3 178.3 ... 178.3 178.3</div><input id='attrs-00ef7fe8-2c21-4981-b5d9-b3b905ad8233' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-00ef7fe8-2c21-4981-b5d9-b3b905ad8233' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-235601aa-612c-446c-83d7-88f9d514cccd' class='xr-var-data-in' type='checkbox'><label for='data-235601aa-612c-446c-83d7-88f9d514cccd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3],
       [178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3],
       [178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3],
       ...,
       [178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3],
       [178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3],
       [178.3, 178.3, 178.3, ..., 178.3, 178.3, 178.3]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>H</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>119.0 119.0 119.0 ... 119.0 119.0</div><input id='attrs-f208e11e-0474-46c6-a6c3-4e0e6b143081' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f208e11e-0474-46c6-a6c3-4e0e6b143081' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-729f9323-a6eb-4bc2-a94a-a263f806876e' class='xr-var-data-in' type='checkbox'><label for='data-729f9323-a6eb-4bc2-a94a-a263f806876e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[119., 119., 119., ..., 119., 119., 119.],
       [119., 119., 119., ..., 119., 119., 119.],
       [119., 119., 119., ..., 119., 119., 119.],
       ...,
       [119., 119., 119., ..., 119., 119., 119.],
       [119., 119., 119., ..., 119., 119., 119.],
       [119., 119., 119., ..., 119., 119., 119.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>P</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.849e+03 8.257e+03 ... 1.064e+04</div><input id='attrs-f2852d25-f620-4dcc-b925-da081c0a60cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f2852d25-f620-4dcc-b925-da081c0a60cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bad011db-932e-409c-b66f-67160c3e4e24' class='xr-var-data-in' type='checkbox'><label for='data-bad011db-932e-409c-b66f-67160c3e4e24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 4849.15666303,  8256.82527504,  9349.21555429, ...,
         7339.90455836,  9382.06428775,  5485.24121905],
       [    0.        ,     0.        ,     0.        , ...,
            0.        ,     0.        ,     0.        ],
       [10641.85916516, 10641.31250889, 10641.42619428, ...,
        10641.31250889, 10641.85895388, 10641.31250889],
       ...,
       [ 5238.87024851,  6960.58470499,  3364.21653738, ...,
         6961.23755919,  5400.13977828,  6961.23755919],
       [10643.48484798, 10641.32441913, 10640.29336085, ...,
        10641.94802134, 10640.62228383, 10642.95863371],
       [10639.97491761, 10639.92473132, 10639.91920818, ...,
        10639.93644596, 10639.93722645, 10639.92863625]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>REWS</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.707 10.4 10.86 ... 17.63 17.71</div><input id='attrs-d05b975d-347d-4855-ba8e-afb9f778f101' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d05b975d-347d-4855-ba8e-afb9f778f101' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7c4a2cc-828e-49a9-8d75-c1b95bf24284' class='xr-var-data-in' type='checkbox'><label for='data-b7c4a2cc-828e-49a9-8d75-c1b95bf24284' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 8.70739148, 10.4023241 , 10.85525979, ..., 10.02214303,
        10.86887979,  9.08783168],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.76458387, 21.95981825, 21.91921633, ..., 21.95981825,
        21.76465933, 21.95981825],
       ...,
       [ 8.95387404,  9.83495453,  7.70073211, ...,  9.83528514,
         9.0447358 ,  9.83528514],
       [23.97191414, 24.28804821, 24.41856192, ..., 24.20911122,
        24.3769261 , 24.08118561],
       [17.25082391, 17.7526868 , 17.80791824, ..., 17.63554043,
        17.62773546, 17.71363755]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>REWS2</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.707 10.4 10.86 ... 17.63 17.71</div><input id='attrs-72ca5654-b98a-438f-879a-d3f135df0a4c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72ca5654-b98a-438f-879a-d3f135df0a4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-924f5628-1120-407f-9fbd-0613abf26437' class='xr-var-data-in' type='checkbox'><label for='data-924f5628-1120-407f-9fbd-0613abf26437' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 8.70739148, 10.4023241 , 10.85525979, ..., 10.02214303,
        10.86887979,  9.08783168],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.76458387, 21.95981825, 21.91921633, ..., 21.95981825,
        21.76465933, 21.95981825],
       ...,
       [ 8.95387404,  9.83495453,  7.70073211, ...,  9.83528514,
         9.0447358 ,  9.83528514],
       [23.97191414, 24.28804821, 24.41856192, ..., 24.20911122,
        24.3769261 , 24.08118561],
       [17.25082391, 17.7526868 , 17.80791824, ..., 17.63554043,
        17.62773546, 17.71363755]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>REWS3</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.707 10.4 10.86 ... 17.63 17.71</div><input id='attrs-f3022cbb-d67a-4922-8e8d-6a1aa294f1d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3022cbb-d67a-4922-8e8d-6a1aa294f1d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0dc798a-8a5c-4769-b72f-f93b1ea3689e' class='xr-var-data-in' type='checkbox'><label for='data-a0dc798a-8a5c-4769-b72f-f93b1ea3689e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 8.70739148, 10.4023241 , 10.85525979, ..., 10.02214303,
        10.86887979,  9.08783168],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.76458387, 21.95981825, 21.91921633, ..., 21.95981825,
        21.76465933, 21.95981825],
       ...,
       [ 8.95387404,  9.83495453,  7.70073211, ...,  9.83528514,
         9.0447358 ,  9.83528514],
       [23.97191414, 24.28804821, 24.41856192, ..., 24.20911122,
        24.3769261 , 24.08118561],
       [17.25082391, 17.7526868 , 17.80791824, ..., 17.63554043,
        17.62773546, 17.71363755]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>RHO</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.225 1.225 1.225 ... 1.225 1.225</div><input id='attrs-b9aa29a1-1aa1-4ab3-a9f9-963a9290e407' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b9aa29a1-1aa1-4ab3-a9f9-963a9290e407' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be8d4777-dc18-4d22-906e-2efe60bc9779' class='xr-var-data-in' type='checkbox'><label for='data-be8d4777-dc18-4d22-906e-2efe60bc9779' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       ...,
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225],
       [1.225, 1.225, 1.225, ..., 1.225, 1.225, 1.225]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TI</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02 0.02 0.02 ... 0.02 0.02 0.02</div><input id='attrs-c9f899a5-6085-46eb-ab4c-bfb0fc1858f4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c9f899a5-6085-46eb-ab4c-bfb0fc1858f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8fca1785-cb5b-4d0e-996c-196403c3e962' class='xr-var-data-in' type='checkbox'><label for='data-8fca1785-cb5b-4d0e-996c-196403c3e962' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       ...,
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02],
       [0.02, 0.02, 0.02, ..., 0.02, 0.02, 0.02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>WD</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>141.7 141.7 141.7 ... 78.17 78.17</div><input id='attrs-07514368-645c-4c9c-a01e-58e33a3bc3c0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-07514368-645c-4c9c-a01e-58e33a3bc3c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7cce1003-a2ba-48ce-b1d7-0fa6dce3adbc' class='xr-var-data-in' type='checkbox'><label for='data-7cce1003-a2ba-48ce-b1d7-0fa6dce3adbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[141.7087873 , 141.7087873 , 141.7087873 , ..., 141.7087873 ,
        141.7087873 , 141.7087873 ],
       [170.43683738, 170.43683738, 170.43683738, ..., 170.43683738,
        170.43683738, 170.43683738],
       [307.63706155, 307.63706155, 307.63706155, ..., 307.63706155,
        307.63706155, 307.63706155],
       ...,
       [340.81484941, 340.81484941, 340.81484941, ..., 340.81484941,
        340.81484941, 340.81484941],
       [143.09567727, 143.09567727, 143.09567727, ..., 143.09567727,
        143.09567727, 143.09567727],
       [ 78.17054545,  78.17054545,  78.17054545, ...,  78.17054545,
         78.17054545,  78.17054545]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>X</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.29e+03 -234.8 ... -5.796e+03</div><input id='attrs-7d6e5c6f-0660-4134-bd5d-32b0d53a123d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d6e5c6f-0660-4134-bd5d-32b0d53a123d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-950cb604-df78-421a-818f-d02e6096bd9d' class='xr-var-data-in' type='checkbox'><label for='data-950cb604-df78-421a-818f-d02e6096bd9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909],
       [-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909],
       [-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909],
       ...,
       [-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909],
       [-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909],
       [-3290.3575024 ,  -234.75068399,  1334.91378165, ...,
        -6101.77816491,  4853.31375786, -5796.45013909]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Y</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.398e+03 5.433e+03 ... 3.945e+03</div><input id='attrs-3b5a2f0c-0015-42f2-b5b1-1eea2ff06949' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3b5a2f0c-0015-42f2-b5b1-1eea2ff06949' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48b3ee2a-e6d1-4b43-91cb-61c9e796cd15' class='xr-var-data-in' type='checkbox'><label for='data-48b3ee2a-e6d1-4b43-91cb-61c9e796cd15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791],
       [ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791],
       [ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791],
       ...,
       [ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791],
       [ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791],
       [ 1397.53818917,  5433.27806733,  1216.8329491 , ...,
         1772.47714691, -3097.00546394,  3944.70902791]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>YAW</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>141.7 141.7 141.7 ... 78.17 78.17</div><input id='attrs-46825478-0d3e-4c6e-80e7-9f9dd69e0e4a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-46825478-0d3e-4c6e-80e7-9f9dd69e0e4a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c83cbbe-d97c-4c14-b1c0-d1eecf1d4c94' class='xr-var-data-in' type='checkbox'><label for='data-3c83cbbe-d97c-4c14-b1c0-d1eecf1d4c94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[141.7087873 , 141.7087873 , 141.7087873 , ..., 141.7087873 ,
        141.7087873 , 141.7087873 ],
       [170.43683738, 170.43683738, 170.43683738, ..., 170.43683738,
        170.43683738, 170.43683738],
       [307.63706155, 307.63706155, 307.63706155, ..., 307.63706155,
        307.63706155, 307.63706155],
       ...,
       [340.81484941, 340.81484941, 340.81484941, ..., 340.81484941,
        340.81484941, 340.81484941],
       [143.09567727, 143.09567727, 143.09567727, ..., 143.09567727,
        143.09567727, 143.09567727],
       [ 78.17054545,  78.17054545,  78.17054545, ...,  78.17054545,
         78.17054545,  78.17054545]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>order</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>44 33 39 81 57 ... 22 20 27 92 56</div><input id='attrs-c5546884-6ad6-4184-babd-c71b3b24d429' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c5546884-6ad6-4184-babd-c71b3b24d429' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-083deeb5-1acc-43c8-9cd3-ab0fddccfa02' class='xr-var-data-in' type='checkbox'><label for='data-083deeb5-1acc-43c8-9cd3-ab0fddccfa02' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[44, 33, 39, ..., 93, 99, 47],
       [44, 39, 81, ..., 93, 82, 47],
       [99, 18, 97, ..., 39, 33, 44],
       ...,
       [47, 93, 99, ..., 33, 39, 44],
       [44, 39, 33, ..., 93, 99, 47],
       [82,  4, 62, ..., 27, 92, 56]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>order_inv</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>76 77 54 75 85 ... 16 21 89 39 71</div><input id='attrs-5fcd40a3-1e7a-47b5-b34d-1e8ad331771d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5fcd40a3-1e7a-47b5-b34d-1e8ad331771d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3373cc84-5ba4-4440-90f3-5d791442e382' class='xr-var-data-in' type='checkbox'><label for='data-3373cc84-5ba4-4440-90f3-5d791442e382' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[76, 77, 54, ..., 84, 12,  6],
       [84, 85,  4, ..., 68, 90, 17],
       [ 1, 39, 83, ..., 53, 55, 18],
       ...,
       [40,  3, 99, ..., 21, 50, 44],
       [77, 76, 53, ..., 64, 12,  6],
       [78,  7, 85, ..., 89, 39, 71]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>order_ssel</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 ... 312 312 312 312 312</div><input id='attrs-a4d44eae-b3ed-4480-902d-37ffb34d03a3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4d44eae-b3ed-4480-902d-37ffb34d03a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-312fba79-c776-41a6-bdef-02d5a9d85f22' class='xr-var-data-in' type='checkbox'><label for='data-312fba79-c776-41a6-bdef-02d5a9d85f22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[  0,   0,   0, ...,   0,   0,   0],
       [  1,   1,   1, ...,   1,   1,   1],
       [  2,   2,   2, ...,   2,   2,   2],
       ...,
       [310, 310, 310, ..., 310, 310, 310],
       [311, 311, 311, ..., 311, 311, 311],
       [312, 312, 312, ..., 312, 312, 312]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>weight</span></div><div class='xr-var-dims'>(state, turbine)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0002 0.0002 ... 0.0002 0.0002</div><input id='attrs-b60736f1-2e50-41af-8573-9e94f6df242a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b60736f1-2e50-41af-8573-9e94f6df242a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62e0ee52-625a-438c-8ea3-7054b7e4ddda' class='xr-var-data-in' type='checkbox'><label for='data-62e0ee52-625a-438c-8ea3-7054b7e4ddda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002],
       [0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002],
       [0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002],
       ...,
       [0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002],
       [0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002],
       [0.0002, 0.0002, 0.0002, ..., 0.0002, 0.0002, 0.0002]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tname</span></div><div class='xr-var-dims'>(turbine)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;T0&#x27; &#x27;T1&#x27; &#x27;T2&#x27; ... &#x27;T98&#x27; &#x27;T99&#x27;</div><input id='attrs-aeb162b5-70b2-4a54-a616-0f49721cea69' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aeb162b5-70b2-4a54-a616-0f49721cea69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a1ddeda-d6cd-48a6-94c4-26f47418ba2a' class='xr-var-data-in' type='checkbox'><label for='data-8a1ddeda-d6cd-48a6-94c4-26f47418ba2a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;T0&#x27;, &#x27;T1&#x27;, &#x27;T2&#x27;, &#x27;T3&#x27;, &#x27;T4&#x27;, &#x27;T5&#x27;, &#x27;T6&#x27;, &#x27;T7&#x27;, &#x27;T8&#x27;, &#x27;T9&#x27;, &#x27;T10&#x27;,
       &#x27;T11&#x27;, &#x27;T12&#x27;, &#x27;T13&#x27;, &#x27;T14&#x27;, &#x27;T15&#x27;, &#x27;T16&#x27;, &#x27;T17&#x27;, &#x27;T18&#x27;, &#x27;T19&#x27;,
       &#x27;T20&#x27;, &#x27;T21&#x27;, &#x27;T22&#x27;, &#x27;T23&#x27;, &#x27;T24&#x27;, &#x27;T25&#x27;, &#x27;T26&#x27;, &#x27;T27&#x27;, &#x27;T28&#x27;,
       &#x27;T29&#x27;, &#x27;T30&#x27;, &#x27;T31&#x27;, &#x27;T32&#x27;, &#x27;T33&#x27;, &#x27;T34&#x27;, &#x27;T35&#x27;, &#x27;T36&#x27;, &#x27;T37&#x27;,
       &#x27;T38&#x27;, &#x27;T39&#x27;, &#x27;T40&#x27;, &#x27;T41&#x27;, &#x27;T42&#x27;, &#x27;T43&#x27;, &#x27;T44&#x27;, &#x27;T45&#x27;, &#x27;T46&#x27;,
       &#x27;T47&#x27;, &#x27;T48&#x27;, &#x27;T49&#x27;, &#x27;T50&#x27;, &#x27;T51&#x27;, &#x27;T52&#x27;, &#x27;T53&#x27;, &#x27;T54&#x27;, &#x27;T55&#x27;,
       &#x27;T56&#x27;, &#x27;T57&#x27;, &#x27;T58&#x27;, &#x27;T59&#x27;, &#x27;T60&#x27;, &#x27;T61&#x27;, &#x27;T62&#x27;, &#x27;T63&#x27;, &#x27;T64&#x27;,
       &#x27;T65&#x27;, &#x27;T66&#x27;, &#x27;T67&#x27;, &#x27;T68&#x27;, &#x27;T69&#x27;, &#x27;T70&#x27;, &#x27;T71&#x27;, &#x27;T72&#x27;, &#x27;T73&#x27;,
       &#x27;T74&#x27;, &#x27;T75&#x27;, &#x27;T76&#x27;, &#x27;T77&#x27;, &#x27;T78&#x27;, &#x27;T79&#x27;, &#x27;T80&#x27;, &#x27;T81&#x27;, &#x27;T82&#x27;,
       &#x27;T83&#x27;, &#x27;T84&#x27;, &#x27;T85&#x27;, &#x27;T86&#x27;, &#x27;T87&#x27;, &#x27;T88&#x27;, &#x27;T89&#x27;, &#x27;T90&#x27;, &#x27;T91&#x27;,
       &#x27;T92&#x27;, &#x27;T93&#x27;, &#x27;T94&#x27;, &#x27;T95&#x27;, &#x27;T96&#x27;, &#x27;T97&#x27;, &#x27;T98&#x27;, &#x27;T99&#x27;],
      dtype=&#x27;&lt;U3&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-16f23710-9930-4913-8760-5a51ee091701' class='xr-section-summary-in' type='checkbox'  ><label for='section-16f23710-9930-4913-8760-5a51ee091701' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>state</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c5a4b185-ee1a-4bda-bd14-95ca33acfc76' class='xr-index-data-in' type='checkbox'/><label for='index-c5a4b185-ee1a-4bda-bd14-95ca33acfc76' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2000-01-01 00:00:00&#x27;, &#x27;2000-01-01 01:00:00&#x27;,
               &#x27;2000-01-01 02:00:00&#x27;, &#x27;2000-01-01 03:00:00&#x27;,
               &#x27;2000-01-01 04:00:00&#x27;, &#x27;2000-01-01 05:00:00&#x27;,
               &#x27;2000-01-01 06:00:00&#x27;, &#x27;2000-01-01 07:00:00&#x27;,
               &#x27;2000-01-01 08:00:00&#x27;, &#x27;2000-01-01 09:00:00&#x27;,
               ...
               &#x27;2000-07-26 22:00:00&#x27;, &#x27;2000-07-26 23:00:00&#x27;,
               &#x27;2000-07-27 00:00:00&#x27;, &#x27;2000-07-27 01:00:00&#x27;,
               &#x27;2000-07-27 02:00:00&#x27;, &#x27;2000-07-27 03:00:00&#x27;,
               &#x27;2000-07-27 04:00:00&#x27;, &#x27;2000-07-27 05:00:00&#x27;,
               &#x27;2000-07-27 06:00:00&#x27;, &#x27;2000-07-27 07:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;state&#x27;, length=5000, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8efe4e81-5b93-41ca-b8b5-b196b55c0e24' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8efe4e81-5b93-41ca-b8b5-b196b55c0e24' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>During the very first calculation, the algorithm checks if an engine is already up and running. If not, the default engine is created. We can check the currently active engine by the following function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">foxes</span><span class="o">.</span><span class="n">get_engine</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>Out[7]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DefaultEngine(n_procs=16, chunk_size_states=None, chunk_size_points=20000)
</pre></div></div>
</div>
<p>This shows that the default choice is the <em>DefaultEngine</em>, which selected to run the <em>ProcessEngine</em> for this size of problem. The criteria are:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&gt;=</span> <span class="pre">sqrt(n_procs)</span> <span class="pre">*</span> <span class="pre">(500/n_turbines)**1.5</span></code>: Run engine <code class="docutils literal notranslate"><span class="pre">ProcessEngine</span></code>,</p></li>
<li><p>Else if <code class="docutils literal notranslate"><span class="pre">algo.calc_points()</span></code> has been called and <code class="docutils literal notranslate"><span class="pre">n_points</span> <span class="pre">&gt;</span> <span class="pre">20000</span></code>: Run engine <code class="docutils literal notranslate"><span class="pre">ProcessEngine</span></code>,</p></li>
<li><p>Else: Run engine <code class="docutils literal notranslate"><span class="pre">SingleChunkEngine</span></code>.</p></li>
</ul>
<p>The above selection is based on test runs on a Ubuntu workstation with 64 physical cores and might not be the optimal choice for your system. Be aware of this whenever relying on the default engine for smallish cases - if in doubt, better explicitly specify the engine.</p>
<p>Note that the parameter choice <em>None</em> for the chunk sizes represents a default choice by the engine, and does not mean that there is no chunking in the corresponding dimension.</p>
<p>We can reset the engine by</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">foxes</span><span class="o">.</span><span class="n">reset_engine</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>such that no engine is active afterwards:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">foxes</span><span class="o">.</span><span class="n">get_engine</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
None
</pre></div></div>
</div>
<h2 id="Engine-selection-through-the-algorithm">Engine selection through the algorithm<a class="headerlink" href="#Engine-selection-through-the-algorithm" title="Link to this heading">¶</a></h2>
<p>There are two ways how to select a non-default engine and set all its parameters, as we will explore in this and the following section.</p>
<p>If you are using one algorithm for all calculations, you can select the engine directly via the algorithm’s constructor. Make sure the algorithm is created at the beginning of your script, in particular before creating images, since those might launch the default engine otherwise.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">algo</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Downwind</span><span class="p">(</span>
    <span class="n">farm</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">rotor_model</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
    <span class="n">wake_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bastankhah2014_linear_k004&quot;</span><span class="p">],</span>
    <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;dask&quot;</span><span class="p">,</span>
    <span class="n">n_procs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">chunk_size_states</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
    <span class="n">chunk_size_points</span><span class="o">=</span><span class="mi">4000</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Algorithm &#39;Downwind&#39;: Selecting engine &#39;DaskEngine(n_procs=2, chunk_size_states=2000, chunk_size_points=4000)&#39;
</pre></div></div>
</div>
<p>Here the <em>DaskEngine</em> class was selected, with <em>n_procs</em> value 2 and a user choice of chunk sizes. Notice that the short name from the above table can be used instead of the full class name (which, however, would also work).</p>
<p>For the complete list of constructor arguments of each of the engine classes, please check the API section <em>foxes.engines</em>. Any argument of the engine constructor can directly be added to the constructor of the algorithm, and will then be passed on.</p>
<p>Let’s re-run the calculation using the above selected engine:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">farm_results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">calc_farm</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Initializing model &#39;Timeseries&#39;

Initializing algorithm &#39;Downwind&#39;

--------------------------------------------------
  Running Downwind: calc_farm
--------------------------------------------------
  n_states : 5000
  n_turbines: 100
--------------------------------------------------
  states   : Timeseries()
  rotor    : CentreRotor()
  controller: BasicFarmController()
  wake frame: RotorWD()
--------------------------------------------------
  wakes:
    0) Bastankhah2014_linear_k004: Bastankhah2014(ws_linear, induction=Madsen, k=0.04)
--------------------------------------------------
  partial wakes:
    0) Bastankhah2014_linear_k004: axiwake6, PartialAxiwake(n=6)
--------------------------------------------------
  turbine models:
    0) DTU10MW: PCtFile(D=178.3, H=119.0, P_nominal=10000.0, P_unit=kW, rho=1.225, var_ws_ct=REWS2, var_ws_P=REWS3)
--------------------------------------------------


--------------------------------------------------
  Model oder
--------------------------------------------------
00) basic_ctrl
01) InitFarmData_instance1
02) centre
03) basic_ctrl
  03.0) Post-rotor: DTU10MW
04) SetAmbFarmResults_instance1
05) FarmWakesCalculation_instance1
06) ReorderFarmOutput_instance1
--------------------------------------------------


Input data:

 &lt;xarray.Dataset&gt; Size: 5MB
Dimensions:          (state: 5000, turbine: 100, Timeseries_vars: 2, tmodels: 1)
Coordinates:
  * state            (state) datetime64[ns] 40kB 2000-01-01 ... 2000-07-27T07...
  * Timeseries_vars  (Timeseries_vars) &lt;U2 16B &#39;WD&#39; &#39;WS&#39;
  * tmodels          (tmodels) &lt;U7 28B &#39;DTU10MW&#39;
Dimensions without coordinates: turbine
Data variables:
    weight           (state, turbine) float64 4MB 0.0002 0.0002 ... 0.0002
    Timeseries_data  (state, Timeseries_vars) float64 80kB 141.7 11.24 ... 17.92
    tmodel_sels      (state, turbine, tmodels) bool 500kB True True ... True


Farm variables: AMB_CT, AMB_P, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_RHO, AMB_TI, AMB_WD, AMB_YAW, CT, D, H, P, REWS, REWS2, REWS3, RHO, TI, WD, X, Y, YAW, order, order_inv, order_ssel, weight

Output variables: AMB_CT, AMB_P, AMB_REWS, AMB_REWS2, AMB_REWS3, AMB_RHO, AMB_TI, AMB_WD, AMB_YAW, CT, D, H, P, REWS, REWS2, REWS3, RHO, TI, WD, X, Y, YAW, order, order_inv, order_ssel, weight
DaskEngine: Calculating 5000 states for 100 turbines
Computing 3 chunks using 2 processes


</pre></div></div>
</div>
<p>We can always check the current engine, and reset it if desired:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">foxes</span><span class="o">.</span><span class="n">get_engine</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>Out[12]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DaskEngine(n_procs=2, chunk_size_states=2000, chunk_size_points=4000)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">foxes</span><span class="o">.</span><span class="n">reset_engine</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">foxes</span><span class="o">.</span><span class="n">get_engine</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
None
</pre></div></div>
</div>
<p>For a proper shutdown of the applied engine, make sure you do not forget the <code class="docutils literal notranslate"><span class="pre">foxes.reset_engine()</span></code> command after the final calculation. Alternatively, consider the selection of the engine by a <code class="docutils literal notranslate"><span class="pre">with</span></code> block, as explained in the following section.</p>
<h2 id="Engine-selection-through-a-with-block">Engine selection through a with-block<a class="headerlink" href="#Engine-selection-through-a-with-block" title="Link to this heading">¶</a></h2>
<p>The proper way of using an engine is recommended to apply a Python context manager, i.e., a <em>with</em> block, for creating the engine. This ensures the proper shutdown of the engine, and it also increases the readability concerning the engine choice.</p>
<p>Especially for cluster and pool based engines, which have non-trivial shutdown routines, the <em>with</em> block is always preferrable over the algorithm based engine specification.</p>
<p>The syntax is straight forward. Note that within the context block we create the algorithm without any engine specification. Furthermore, note that the engine object is not required as a parameter for the algorithm, since it is set as a globally accessible object during initialization:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">algo</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Downwind</span><span class="p">(</span>
    <span class="n">farm</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">rotor_model</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
    <span class="n">wake_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bastankhah2014_linear_k004&quot;</span><span class="p">],</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">foxes</span><span class="o">.</span><span class="n">Engine</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
    <span class="s2">&quot;local_cluster&quot;</span><span class="p">,</span> <span class="n">n_procs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">chunk_size_states</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">chunk_size_points</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">):</span>
    <span class="n">farm_results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">calc_farm</span><span class="p">()</span>

    <span class="n">o</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">FlowPlots2D</span><span class="p">(</span><span class="n">algo</span><span class="p">,</span> <span class="n">farm_results</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">gen_states_fig_xy</span><span class="p">(</span><span class="n">FV</span><span class="o">.</span><span class="n">WS</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">states_isel</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Launching local dask cluster..
LocalCluster(232bece3, &#39;tcp://127.0.0.1:40225&#39;, workers=4, threads=16, memory=7.38 GiB)
Dashboard: http://127.0.0.1:8787/status

LocalClusterEngine: Calculating 5000 states for 100 turbines
Submitting 3 chunks to 4 processes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00&lt;00:00,  5.85it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing 3 chunks using 4 processes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:13&lt;00:00,  4.46s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LocalClusterEngine: Calculating data at 223533 points for 1 states
Submitting 23 chunks to 4 processes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:03&lt;00:00,  5.96it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing 23 chunks using 4 processes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23/23 [00:00&lt;00:00, 177.87it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_parallelization_33_8.png" src="../_images/notebooks_parallelization_33_8.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shutting down LocalCluster
</pre></div></div>
</div>
<p>Notice the <em>Dashboard</em> link which for this particular choice of engine displays the progress and cluster load during the execution.</p>
<p>After the computation the engine is not set, as expected:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">foxes</span><span class="o">.</span><span class="n">get_engine</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
None
</pre></div></div>
</div>
<h2 id="Manual-engine-selection">Manual engine selection<a class="headerlink" href="#Manual-engine-selection" title="Link to this heading">¶</a></h2>
<p>It can be useful to create the <code class="docutils literal notranslate"><span class="pre">Engine</span></code> object manually, especially when working in a notebook. In that case the engine is often needed many times, and switching it on and off again all the time is not very efficient.</p>
<p>For such cases, create the engine in the beginning and initialize it:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">engine</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">Engine</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;process&quot;</span><span class="p">,</span> <span class="n">n_procs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">chunk_size_states</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">engine</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>Afterwards, run all of your code with that engine:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">algo</span> <span class="o">=</span> <span class="n">foxes</span><span class="o">.</span><span class="n">algorithms</span><span class="o">.</span><span class="n">Downwind</span><span class="p">(</span>
    <span class="n">farm</span><span class="p">,</span>
    <span class="n">states</span><span class="p">,</span>
    <span class="n">rotor_model</span><span class="o">=</span><span class="s2">&quot;centre&quot;</span><span class="p">,</span>
    <span class="n">wake_models</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bastankhah2014_linear_k004&quot;</span><span class="p">],</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">farm_results</span> <span class="o">=</span> <span class="n">algo</span><span class="o">.</span><span class="n">calc_farm</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">farm_results</span><span class="p">[</span><span class="n">FV</span><span class="o">.</span><span class="n">REWS</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ProcessEngine: Calculating 5000 states for 100 turbines
ProcessEngine: Computing 3 chunks using 4 processes
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:10&lt;00:00,  3.43s/it]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.DataArray &#39;REWS&#39; (state: 5000, turbine: 100)&gt; Size: 4MB
array([[ 8.70739148, 10.4023241 , 10.85525979, ..., 10.02214303,
        10.86887979,  9.08783168],
       [28.52142919, 28.52142919, 28.52142919, ..., 28.52142919,
        28.52142919, 28.52142919],
       [21.76458387, 21.95981825, 21.91921633, ..., 21.95981825,
        21.76465933, 21.95981825],
       ...,
       [ 8.95387404,  9.83495453,  7.70073211, ...,  9.83528514,
         9.0447358 ,  9.83528514],
       [23.97191414, 24.28804821, 24.41856192, ..., 24.20911122,
        24.3769261 , 24.08118561],
       [17.25082391, 17.7526868 , 17.80791824, ..., 17.63554043,
        17.62773546, 17.71363755]])
Coordinates:
  * state    (state) datetime64[ns] 40kB 2000-01-01 ... 2000-07-27T07:00:00
Dimensions without coordinates: turbine
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>After everything is done, shutdown the engine:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>In [18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">engine</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">engine</span></code> object still exists after this, so you can always decide to initialize/finalize it again, if needed.</p>
<h2 id="Remarks-&amp;-recommendations">Remarks &amp; recommendations<a class="headerlink" href="#Remarks-&-recommendations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Take the time to think about your engine choice, and its parameters. Your choice might matter a lot for the performance of your run.</p></li>
<li><p>In general, all engines accept the parameters <code class="docutils literal notranslate"><span class="pre">n_procs</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size_states</span></code>, <code class="docutils literal notranslate"><span class="pre">chunk_size_points</span></code> (the <code class="docutils literal notranslate"><span class="pre">single</span></code> engine ignores them, though).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">n_procs</span></code> is not set, the maximal number of processes is applied, according to <code class="docutils literal notranslate"><span class="pre">os.cpu_count()</span></code> for Python version &lt; 3.13 and <code class="docutils literal notranslate"><span class="pre">os.process_cpu_count()</span></code> for Python version &gt;= 3.13.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">chunk_size_states</span></code> is not set, the number of states is divided by <code class="docutils literal notranslate"><span class="pre">n_procs</span></code>. This might be non-optimal for small cases.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">chunk_size_points</span></code> is not set and there is more than one states chunk, the full number of points is selected such that there is only one point chunk for each state chunk. If there is only one states chunk, the default points chunk size is the number of points divided by <code class="docutils literal notranslate"><span class="pre">n_procs</span></code>.</p></li>
<li><p>In general, for not too small cases, the default <code class="docutils literal notranslate"><span class="pre">process</span></code> engine is a good choice for runs on a linux based laptop or a workstation computer, or within Windows WSL.</p></li>
<li><p>For runs on native Windows, i.e., without WSL, the best engine choices have not been tested. Make sure you try different ones, e.g. <code class="docutils literal notranslate"><span class="pre">process</span></code>, <code class="docutils literal notranslate"><span class="pre">multiprocess</span></code>, <code class="docutils literal notranslate"><span class="pre">dask</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, and also vary the parameters.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">mpi</span></code> engine requires the installation of MPI on the system, for example <em>OpenMPI</em>.</p></li>
<li><p>If you run into memory problems, the best options are to either reduce the number of processes or the chunk sizes.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">dask</span></code> engine has additional options, accessible through the <em>dask_pars</em> dictionary parameter, for example the <em>scheduler</em> choice. See API and <a class="reference external" href="https://docs.dask.org/en/stable/scheduling.html">dask documentation</a> for syntax and more info.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">local_cluster</span></code> is not always faster than the <code class="docutils literal notranslate"><span class="pre">process</span></code>, <code class="docutils literal notranslate"><span class="pre">multiprocess</span></code> or <code class="docutils literal notranslate"><span class="pre">dask</span></code> engines, but offers a more detailed setup. For example, the memory and the number of threads per worker can be modified, if needed.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">numpy</span></code> and <code class="docutils literal notranslate"><span class="pre">single</span></code> engines are intended for testing and small cases, and also for sequential runs without large point evaluations, or for smallish runs with wake frame <code class="docutils literal notranslate"><span class="pre">dyn_wakes</span></code>.</p></li>
<li><p>In notebooks, the preferred engine selection method is the <code class="docutils literal notranslate"><span class="pre">Manual</span> <span class="pre">engine</span> <span class="pre">selection</span></code> described above.</p></li>
</ul>






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../models.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Models" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Models
            </div>
          </div>
        </a>
      
      
        
        <a href="../examples.html" class="md-footer__link md-footer__link--next" aria-label="Next: Examples" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Examples
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2024, Fraunhofer IWES.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.f9d9eeeb247ace16c.min.js?v=8ec58cb5"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>